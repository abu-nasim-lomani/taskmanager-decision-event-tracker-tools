{% load static %}
<!DOCTYPE html>
<html lang="en" class="h-full bg-slate-50">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}DecisionTracker - Professional Decision Management{% endblock %}</title>
    <link href="{% static 'css/dist/styles.css' %}" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <style>
        body { font-family: 'Inter', system-ui, -apple-system, sans-serif; }
    </style>
</head>
<body class="h-full pb-16 lg:pb-0 font-inter antialiased">
    <div x-data="{ sidebarOpen: false, userMenuOpen: false }" class="min-h-full">
        <!-- Mobile sidebar backdrop -->
        <div x-show="sidebarOpen" x-transition:enter="transition-opacity ease-linear duration-200" 
             x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" 
             x-transition:leave="transition-opacity ease-linear duration-200" 
             x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" 
             class="fixed inset-0 bg-gray-900/80 lg:hidden z-40" @click="sidebarOpen = false">
        </div>

        <!-- Mobile sidebar -->
        <div class="relative z-50 lg:hidden">
            <div x-show="sidebarOpen" x-transition:enter="transition ease-in-out duration-300 transform" 
                 x-transition:enter-start="-translate-x-full" x-transition:enter-end="translate-x-0" 
                 x-transition:leave="transition ease-in-out duration-300 transform" 
                 x-transition:leave-start="translate-x-0" x-transition:leave-end="-translate-x-full" 
                 class="fixed inset-y-0 left-0 w-64 bg-gradient-to-b from-slate-800 to-slate-900 shadow-xl">
                <div class="flex flex-col h-full">
                    <!-- Logo -->
                    <div class="flex items-center px-6 py-6 border-b border-slate-700/50">
                        <div class="bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl p-2 mr-3 shadow-lg">
                            <i class="fa-solid fa-bullhorn text-white text-lg"></i>
                        </div>
                        <span class="text-white font-bold text-xl tracking-tight">DecisionTracker</span>
                    </div>

                    <!-- Navigation -->
                    <nav class="flex-1 px-4 py-6 space-y-1 text-white" style="color: white;">
                        <a href="{% url 'meeting_list' %}" class="nav-mobile-item group flex items-center px-3 py-3 text-sm font-medium rounded-xl transition-all duration-200">
                            <i class="fa-solid fa-gauge-high mr-3 text-slate-400 group-hover:text-blue-400 w-5 text-center"></i>
                            <span>Dashboard</span>
                        </a>
                        <a href="{% url 'my_tasks' %}" class="nav-mobile-item group flex items-center px-3 py-3 text-sm font-medium rounded-xl transition-all duration-200">
                            <i class="fa-solid fa-tasks mr-3 text-slate-400 group-hover:text-blue-400 w-5 text-center"></i>
                            <span>My Tasks</span>
                        </a>
                        <a href="{% url 'event_list' %}" class="nav-mobile-item group flex items-center px-3 py-3 text-sm font-medium rounded-xl transition-all duration-200">
                            <i class="fa-solid fa-calendar-star mr-3 text-slate-400 group-hover:text-blue-400 w-5 text-center"></i>
                            <span>Events</span>
                        </a>
                        {% if request.user.is_superuser or request.user.role == 'MANAGEMENT' %}
                        <a href="{% url 'management_dashboard' %}" class="nav-mobile-item group flex items-center px-3 py-3 text-sm font-medium rounded-xl transition-all duration-200">
                            <i class="fa-solid fa-users-gear mr-3 text-slate-400 group-hover:text-blue-400 w-5 text-center"></i>
                            <span>Management</span>
                        </a>
                        {% endif %}
                        <a href="{% url 'profile' %}" class="nav-mobile-item group flex items-center px-3 py-3 text-sm font-medium rounded-xl transition-all duration-200">
                            <i class="fa-solid fa-gear mr-3 text-slate-400 group-hover:text-blue-400 w-5 text-center"></i>
                            <span>Settings</span>
                        </a>
                    </nav>

                    <!-- User section -->
                    <div class="px-4 py-4 border-t border-slate-700/50">
                        {% if user.is_authenticated %}
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center mr-3 shadow-lg">
                                    <span class="font-bold text-white text-sm">{{ request.user.username|first|upper }}</span>
                                </div>
                                <div>
                                    <p class="text-sm font-semibold text-white">{{ request.user.username|capfirst }}</p>
                                    <p class="text-xs font-medium text-slate-400">{{ request.user.get_role_display }}</p>
                                </div>
                            </div>
                            <form action="{% url 'logout' %}" method="post">
                                {% csrf_token %}
                                <button type="submit" title="Log Out" class="bg-slate-700/50 hover:bg-slate-700 w-10 h-10 rounded-lg flex items-center justify-center transition-colors">
                                    <i class="fa-solid fa-right-from-bracket text-slate-400 hover:text-white"></i>
                                </button>
                            </form>
                        </div>
                        {% else %}
                        <a href="{% url 'login' %}" class="nav-mobile-item group flex items-center px-3 py-3 text-sm font-medium rounded-xl transition-all duration-200">
                            <i class="fa-solid fa-right-to-bracket mr-3 text-slate-400 group-hover:text-blue-400"></i>
                            <span>Log In</span>
                        </a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Desktop sidebar -->
        <div class="hidden lg:fixed lg:inset-y-0 lg:flex lg:w-64 lg:flex-col">
            <div class="flex flex-col flex-grow bg-gradient-to-b from-slate-800 to-slate-900 pt-5 pb-4 overflow-y-auto shadow-xl">
                <div class="flex items-center flex-shrink-0 px-6">
                    <div class="bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl p-2 mr-3 shadow-lg">
                        <i class="fa-solid fa-bullhorn text-white text-lg"></i>
                    </div>
                    <span class="text-white font-bold text-xl tracking-tight">DecisionTracker</span>
                </div>
                <nav class="mt-8 flex-1 px-4 space-y-1">
                    <a href="{% url 'meeting_list' %}" class="nav-desktop-item group flex items-center px-3 py-3 text-sm font-medium rounded-xl transition-all duration-200">
                        <i class="fa-solid fa-gauge-high mr-3 text-slate-400 group-hover:text-blue-400 w-5 text-center"></i>
                        Dashboard
                    </a>
                    <a href="{% url 'my_tasks' %}" class="nav-desktop-item group flex items-center px-3 py-3 text-sm font-medium rounded-xl transition-all duration-200">
                        <i class="fa-solid fa-tasks mr-3 text-slate-400 group-hover:text-blue-400 w-5 text-center"></i>
                        My Tasks
                    </a>
                    <a href="{% url 'event_list' %}" class="nav-desktop-item group flex items-center px-3 py-3 text-sm font-medium rounded-xl transition-all duration-200">
                        <i class="fa-solid fa-calendar-star mr-3 text-slate-400 group-hover:text-blue-400 w-5 text-center"></i>
                        Events
                    </a>
                    {% if request.user.is_superuser or request.user.role == 'MANAGEMENT' %}
                    <a href="{% url 'management_dashboard' %}" class="nav-desktop-item group flex items-center px-3 py-3 text-sm font-medium rounded-xl transition-all duration-200">
                        <i class="fa-solid fa-users-gear mr-3 text-slate-400 group-hover:text-blue-400 w-5 text-center"></i>
                        Management
                    </a>
                    {% endif %}
                    <a href="{% url 'profile' %}" class="nav-desktop-item group flex items-center px-3 py-3 text-sm font-medium rounded-xl transition-all duration-200">
                        <i class="fa-solid fa-gear mr-3 text-slate-400 group-hover:text-blue-400 w-5 text-center"></i>
                        Settings
                    </a>
                </nav>
                <div class="px-4 py-4 border-t border-slate-700/50 mt-auto">
                    {% if user.is_authenticated %}
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <div class="w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center mr-3 shadow-lg">
                                <span class="font-bold text-white text-sm">{{ request.user.username|first|upper }}</span>
                            </div>
                            <div>
                                <p class="text-sm font-semibold text-white">{{ request.user.username|capfirst }}</p>
                                <p class="text-xs font-medium text-slate-400">{{ request.user.get_role_display }}</p>
                            </div>
                        </div>
                        <form action="{% url 'logout' %}" method="post">
                            {% csrf_token %}
                            <button type="submit" title="Log Out" class="bg-slate-700/50 hover:bg-slate-700 w-10 h-10 rounded-lg flex items-center justify-center transition-colors">
                                <i class="fa-solid fa-right-from-bracket text-slate-400 hover:text-white"></i>
                            </button>
                        </form>
                    </div>
                    {% else %}
                    <a href="{% url 'login' %}" class="nav-desktop-item group flex items-center px-3 py-3 text-sm font-medium rounded-xl transition-all duration-200">
                        <i class="fa-solid fa-right-to-bracket mr-3 text-slate-400 group-hover:text-blue-400"></i>
                        Log In
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Main content -->
        <div class="flex flex-1 flex-col lg:pl-64">
            <!-- Mobile header -->
            <div class="sticky top-0 z-30 bg-white/80 backdrop-blur-sm border-b border-gray-200/50 lg:hidden">
                <div class="flex items-center justify-between px-4 py-3">
                    <button @click="sidebarOpen = true" type="button" class="inline-flex items-center justify-center w-10 h-10 rounded-lg bg-white border border-gray-200 text-gray-600 hover:text-gray-900 hover:border-gray-300 transition-colors shadow-sm">
                        <i class="fa-solid fa-bars text-lg"></i>
                    </button>
                    <h1 class="text-lg font-semibold text-gray-900">{% block page_title %}Dashboard{% endblock %}</h1>
                    <div class="w-10"></div> <!-- Spacer for balance -->
                </div>
            </div>

            <!-- Desktop header -->
            <header class="sticky top-0 z-30 bg-white/80 backdrop-blur-sm border-b border-gray-200/50 shadow-sm hidden lg:block">
                <div class="mx-auto max-w-7xl px-6 py-4 flex items-center justify-between">
                    <h1 class="text-2xl font-bold tracking-tight text-gray-900">Dashboard</h1>
                    {% if request.user.is_superuser or request.user.role == 'MANAGEMENT' %}
                    <div class="flex items-center space-x-4">
                        <a href="{% url 'meeting_create' %}" class="bg-gradient-to-br from-blue-600 to-indigo-700 hover:from-blue-700 hover:to-indigo-800 text-white px-4 py-2.5 rounded-xl text-sm font-semibold flex items-center transition-all duration-200 shadow-lg hover:shadow-xl">
                            <i class="fa-solid fa-plus mr-2"></i> New Meeting
                        </a>
                    </div>
                    {% endif %}
                </div>
            </header>

            <!-- Page content -->
            <main class="flex-1">
                <div class="py-6">
                    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
                        {% block content %}{% endblock %}
                    </div>
                </div>
            </main>
        </div>

        <!-- Mobile bottom navigation -->
        <div class="lg:hidden fixed bottom-0 left-0 z-40 w-full h-20 bg-white/80 backdrop-blur-sm border-t border-gray-200/50">
            <div class="grid h-full max-w-lg grid-cols-4 mx-auto font-medium">
                <a href="{% url 'meeting_list' %}" class="mobile-nav-item flex flex-col items-center justify-center px-2 hover:bg-gray-50/50 group transition-colors">
                    <div class="w-12 h-12 rounded-xl flex items-center justify-center group-hover:bg-blue-50 transition-colors">
                        <i class="fa-solid fa-gauge-high text-gray-500 group-hover:text-blue-600 text-lg"></i>
                    </div>
                    <span class="text-xs text-gray-600 group-hover:text-blue-600 mt-1 font-medium">Dashboard</span>
                </a>
                <a href="{% url 'my_tasks' %}" class="mobile-nav-item flex flex-col items-center justify-center px-2 hover:bg-gray-50/50 group transition-colors">
                    <div class="w-12 h-12 rounded-xl flex items-center justify-center group-hover:bg-blue-50 transition-colors">
                        <i class="fa-solid fa-tasks text-gray-500 group-hover:text-blue-600 text-lg"></i>
                    </div>
                    <span class="text-xs text-gray-600 group-hover:text-blue-600 mt-1 font-medium">My Tasks</span>
                </a>
                <div class="flex items-center justify-center relative">
                    {% if request.user.is_superuser or request.user.role == 'MANAGEMENT' %}
                    <a href="{% url 'meeting_create' %}" class="absolute -top-6 inline-flex items-center justify-center w-14 h-14 font-medium bg-gradient-to-br from-blue-600 to-indigo-700 hover:from-blue-700 hover:to-indigo-800 rounded-2xl text-white shadow-lg hover:shadow-xl transition-all duration-200 border-4 border-white">
                        <i class="fa-solid fa-plus text-xl"></i>
                    </a>
                    {% endif %}
                </div>
                <a href="{% url 'profile' %}" class="mobile-nav-item flex flex-col items-center justify-center px-2 hover:bg-gray-50/50 group transition-colors">
                    <div class="w-12 h-12 rounded-xl flex items-center justify-center group-hover:bg-blue-50 transition-colors">
                        <i class="fa-solid fa-gear text-gray-500 group-hover:text-blue-600 text-lg"></i>
                    </div>
                    <span class="text-xs text-gray-600 group-hover:text-blue-600 mt-1 font-medium">Settings</span>
                </a>
            </div>
        </div>
    </div>

    <script src="{% static 'theme/main.js' %}"></script>
    
    <!--
        The following styles used @apply, which is only valid in Tailwind CSS source files.
        To avoid errors, use Tailwind utility classes directly in your HTML elements.
        If you want to keep custom classes, define them in your Tailwind CSS source file instead.
    -->
</body>
</html>