{% extends 'theme/base.html' %}

{% block title %}Edit Task: {{ task.title }} - DecisionTracker{% endblock %}
{% block page_title %}Edit Task{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto space-y-6">
    <!-- Header Card -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
        <div class="flex items-center justify-between">
            <div>
                <h2 class="text-2xl font-bold text-gray-900 flex items-center">
                    <i class="fa-solid fa-pen-to-square mr-3 text-blue-600"></i>
                    Edit Task
                </h2>
                <div class="flex items-center space-x-4 mt-2 text-sm text-gray-600">
                    <span class="flex items-center">
                        <i class="fa-solid fa-bullseye mr-2 text-blue-500"></i>
                        {{ task.title }}
                    </span>
                    <span class="flex items-center">
                        <i class="fa-solid fa-calendar-day mr-2 text-green-500"></i>
                        From: 
                        <a href="{% url 'meeting_detail' task.meeting.pk %}" class="ml-1 text-blue-600 hover:underline font-medium">
                            {{ task.meeting.title }}
                        </a>
                    </span>
                </div>
            </div>
            <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center">
                <i class="fa-solid fa-tasks text-blue-600 text-xl"></i>
            </div>
        </div>
    </div>

    <!-- Edit Form Card -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
        <div class="bg-gradient-to-r from-gray-50 to-white px-6 py-4 border-b border-gray-200">
            <h3 class="text-lg font-semibold text-gray-900 flex items-center">
                <i class="fa-solid fa-gear mr-2 text-gray-600"></i>
                Task Details
            </h3>
        </div>
        
        <form method="post" class="p-6 space-y-6">
            {% csrf_token %}

            <!-- Title & Description -->
            <div class="space-y-4  ">
                <div class="space-y-2">
                    <label for="{{ form.title.id_for_label }}" class="block text-sm font-semibold text-gray-700 flex items-center">
                        <i class="fa-solid fa-heading mr-2 text-blue-500 text-sm"></i>
                        {{ form.title.label }}
                    </label>
                    <div class="relative">
                        {{ form.title }}
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            
                        </div>
                    </div>
                </div>
                
                <div class="space-y-2">
                    <label for="{{ form.description.id_for_label }}" class="block text-sm font-semibold text-gray-700 flex items-center">
                        <i class="fa-solid fa-align-left mr-2 text-blue-500 text-sm"></i>
                        {{ form.description.label }}
                    </label>
                    <div class="relative">
                        {{ form.description }}
                    </div>
                </div>
            </div>

            <!-- Owner & Due Date -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                {% if 'owner' in form.fields %}
                <div class="space-y-2">
                    <label for="{{ form.owner.id_for_label }}" class="block text-sm font-semibold text-gray-700 flex items-center">
                        <i class="fa-solid fa-user mr-2 text-blue-500 text-sm"></i>
                        {{ form.owner.label }}
                    </label>
                    <div class="relative">
                        {{ form.owner }}
                        
                    </div>
                </div>
                {% endif %}
                
                <div class="space-y-2">
                    <label for="{{ form.due_date.id_for_label }}" class="block text-sm font-semibold text-gray-700 flex items-center">
                        <i class="fa-regular fa-calendar mr-2 text-blue-500 text-sm"></i>
                        {{ form.due_date.label }}
                    </label>
                    <div class="relative">
                        {{ form.due_date }}
                        
                    </div>
                </div>
            </div>

            <!-- Priority & Status -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-2">
                    <label for="{{ form.priority.id_for_label }}" class="block text-sm font-semibold text-gray-700 flex items-center">
                        <i class="fa-solid fa-flag mr-2 text-blue-500 text-sm"></i>
                        {{ form.priority.label }}
                    </label>
                    <div class="relative">
                        {{ form.priority }}
                        
                    </div>
                </div>
                
                <div class="space-y-2">
                    <label for="{{ form.status.id_for_label }}" class="block text-sm font-semibold text-gray-700 flex items-center">
                        <i class="fa-solid fa-bars-progress mr-2 text-blue-500 text-sm"></i>
                        {{ form.status.label }}
                    </label>
                    <div class="relative">
                        {{ form.status }}
                        
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex items-center justify-between pt-6 border-t border-gray-200">
               
                
                <div class="flex items-center space-x-3">
                    <a href="{% url 'meeting_detail' task.meeting.pk %}" class="inline-flex items-center justify-center py-2.5 px-6 border border-gray-300 rounded-lg text-sm font-semibold text-gray-700 bg-white hover:bg-gray-50 transition-all duration-200 shadow-sm hover:shadow-md">
                        <i class="fa-solid fa-arrow-left mr-2"></i>
                        Back to Meeting
                    </a>
                    <button type="submit" class="inline-flex items-center justify-center py-2.5 px-6 border border-transparent rounded-lg text-sm font-semibold text-white bg-blue-600 hover:bg-blue-700 transition-all duration-200 shadow-lg hover:shadow-xl">
                        <i class="fa-solid fa-floppy-disk mr-2"></i>
                        Update Task
                    </button>
                </div>
            </div>
        </form>
    </div>

    <!-- Task Info Card -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-[50px]">
        <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
            <i class="fa-solid fa-circle-info mr-2 text-gray-600"></i>
            Task Information
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="space-y-3">
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                    <span class="text-sm font-medium text-gray-600">Created</span>
                    <span class="text-sm text-gray-900">{{ task.created_at|date:"M d, Y" }}</span>
                </div>
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                    <span class="text-sm font-medium text-gray-600">Last Updated</span>
                    <span class="text-sm text-gray-900">{{ task.updated_at|date:"M d, Y" }}</span>
                </div>
            </div>
            <div class="space-y-3">
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                    <span class="text-sm font-medium text-gray-600">Meeting</span>
                    <span class="text-sm text-gray-900 truncate ml-2">{{ task.meeting.title }}</span>
                </div>
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                    <span class="text-sm font-medium text-gray-600">Current Status</span>
                    <span class="text-sm font-semibold px-2 py-1 rounded-full 
                        {% if task.status == 'COMPLETED' %}bg-green-100 text-green-800
                        {% elif task.status == 'IN_PROGRESS' %}bg-blue-100 text-blue-800
                        {% elif task.status == 'BLOCKED' %}bg-amber-100 text-amber-800
                        {% else %}bg-gray-100 text-gray-800{% endif %}">
                        {{ task.get_status_display }}
                    </span>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    /* Form styling using Tailwind classes */
    input, textarea, select {
        @apply w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white;
    }
    
    textarea {
        @apply pl-10 pt-3;
        min-height: 100px;
    }
</style>
{% endblock %}