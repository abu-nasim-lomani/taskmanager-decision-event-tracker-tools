{% extends 'theme/base.html' %}

{% block title %}Dashboard{% endblock %}
{% block page_title %}Meetings Dashboard{% endblock %}

{% block content %}
<div class="space-y-8">
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <div class="bg-white p-5 rounded-xl border border-gray-200 shadow-sm">
            <div class="flex items-center">
                <div class="rounded-full bg-blue-100 p-3 mr-4">
                    <i class="fa-solid fa-calendar-day text-blue-600 text-xl"></i>
                </div>
                <div>
                    <p class="text-sm font-medium text-gray-500">Total Meetings</p>
                    <p class="text-2xl font-semibold text-gray-900">{{ total_meetings_count }}</p>
                </div>
            </div>
        </div>
        <div class="bg-white p-5 rounded-xl border border-gray-200 shadow-sm">
             <div class="flex items-center">
                <div class="rounded-full bg-green-100 p-3 mr-4"><i class="fa-solid fa-check-circle text-green-600 text-xl"></i></div>
                <div>
                    <p class="text-sm font-medium text-gray-500">Completed</p>
                    <p class="text-2xl font-semibold text-gray-900">{{ completed_meetings_count }}</p>
                </div>
            </div>
        </div>
        <div class="bg-white p-5 rounded-xl border border-gray-200 shadow-sm">
            <div class="flex items-center">
                <div class="rounded-full bg-yellow-100 p-3 mr-4"><i class="fa-solid fa-tasks text-yellow-600 text-xl"></i></div>
                <div>
                    <p class="text-sm font-medium text-gray-500">Total Tasks</p>
                    <p class="text-2xl font-semibold text-gray-900">{{ total_tasks_count }}</p>
                </div>
            </div>
        </div>
        <div class="bg-white p-5 rounded-xl border border-gray-200 shadow-sm">
            <div class="flex items-center">
                <div class="rounded-full bg-purple-100 p-3 mr-4"><i class="fa-solid fa-hourglass-half text-purple-600 text-xl"></i></div>
                <div>
                    <p class="text-sm font-medium text-gray-500">Avg. Duration</p>
                    <p class="text-2xl font-semibold text-gray-900">
                        {% if avg_duration %}{{ avg_duration|floatformat:0 }} min{% else %}N/A{% endif %}
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
        <div class="border-b border-gray-200 bg-gray-50 px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider">
            <div class="flex items-center">
                <div class="w-7/12">Meeting Details</div>
                <div class="w-3/12">Date & Time</div>
                <div class="w-2/12 text-right">Actions</div>
            </div>
        </div>
        
        <ul class="divide-y divide-gray-200">
            {% for meeting in meetings %}
            <li class="px-6 py-4 transition-colors hover:bg-gray-50">
                <div class="flex items-center justify-between">
                    <div class="w-7/12">
                        <p class="text-md font-semibold text-gray-900">{{ meeting.title }}</p>
                        <p class="text-sm text-gray-500 mt-1">{{ meeting.tasks.count }} tasks</p>
                    </div>
                    <div class="w-3/12">
                        <span class="text-sm text-gray-600">{{ meeting.meeting_time|date:"F d, Y, P" }}</span>
                    </div>
                    <div class="w-2/12 flex justify-end items-center space-x-4">
                        <a href="{% url 'meeting_detail' meeting.pk %}" class="text-gray-400 hover:text-blue-600" title="View Details">
                            <i class="fa-solid fa-eye"></i>
                        </a>
                        <a href="{% url 'meeting_update' meeting.pk %}" class="text-gray-400 hover:text-indigo-600" title="Edit Meeting">
                            <i class="fa-solid fa-pen-to-square"></i>
                        </a>
                        <form action="{% url 'meeting_delete' meeting.pk %}" method="post" onsubmit="return confirm('Are you sure?');" class="inline">
                            {% csrf_token %}
                            <button type="submit" class="text-gray-400 hover:text-red-600" title="Delete Meeting"><i class="fa-solid fa-trash-can"></i></button>
                        </form>
                    </div>
                </div>
            </li>
            {% empty %}
            <li class="px-6 py-12 text-center">
                <h3 class="mt-2 text-sm font-medium text-gray-900">No meetings found.</h3>
                <p class="mt-1 text-sm text-gray-500">Get started by creating a new meeting.</p>
                <div class="mt-6">
                    <a href="{% url 'meeting_create' %}" class="inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700">
                        <i class="fa-solid fa-plus -ml-1 mr-2"></i> New Meeting
                    </a>
                </div>
            </li>
            {% endfor %}
        </ul>
    </div>

    {% if meetings.has_other_pages %}
    <div class="bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6 mt-4 rounded-b-xl">
        <div class="hidden sm:flex-1 sm:flex sm:items-center sm:justify-between">
            <div><p class="text-sm text-gray-700">Showing <span class="font-medium">{{ meetings.start_index }}</span> to <span class="font-medium">{{ meetings.end_index }}</span> of <span class="font-medium">{{ meetings.paginator.count }}</span> results</p></div>
            <div>
                <nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px">
                    {% if meetings.has_previous %}<a href="?page={{ meetings.previous_page_number }}" class="relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50"><i class="fa-solid fa-chevron-left h-5 w-5"></i></a>{% endif %}
                    {% for i in meetings.paginator.page_range %}<a href="?page={{ i }}" class="relative inline-flex items-center px-4 py-2 border text-sm font-medium {% if meetings.number == i %}z-10 bg-indigo-50 border-indigo-500 text-indigo-600{% else %}bg-white border-gray-300 text-gray-500 hover:bg-gray-50{% endif %}">{{ i }}</a>{% endfor %}
                    {% if meetings.has_next %}<a href="?page={{ meetings.next_page_number }}" class="relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50"><i class="fa-solid fa-chevron-right h-5 w-5"></i></a>{% endif %}
                </nav>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}